<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Shortener</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
  </head>

  <body>

    <h1>URL Shortener</h1>

    <form id="input-form">
      <input type="text" id="long-url" placeholder="Enter URL to shorten" required>
      <button type="submit">submit</button>
    </form>

    <span id="result"></span>
    <a id="hyperlink" href="" target="_blank"></a>

<script>
const form = document.getElementById('input-form');

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const longUrl = document.getElementById('long-url').value;

  try {
    const response = await fetch(
      `http://10.0.0.80:8000/api/v1/shorten`,
      { 
        method: 'POST',
        body: JSON.stringify({
          url: longUrl,
        }),
        headers: {
          "Content-Type": "application/json; charset=UTF-8"
        }
      }
    );

    if (!response.ok) {
      throw new Error(`Server error: ${response.status}`);
    }

    const jsonObj = await response.json();

    console.log(jsonObj.data.shortUrl)

    document.getElementById('result').innerText = 'Short URL: ';
    document.getElementById('hyperlink').innerText = `http://10.0.0.80:8000/${jsonObj.data.shortUrl}`;
    document.getElementById('hyperlink').href = `http://10.0.0.80:8000/${jsonObj.data.shortUrl}`;

  } catch (err) {
    document.getElementById('result').innerText =
      `Error: ${err.message}`;
  }
});
</script>

</body>
</html>
